---
title: Directory Traversal with Burp Suite
permalink: /burp1
parent: Pentesting
---
# Directory Traversal with Burp Suite
{: .no_toc }

{: .note }
Pentesting, Ethical Hacking, Kali Linux, Burp Suite, Web Application Security, Virtual Machines
{: .fs-3 }

#### Contents
{: .no_toc }
- TOC
{:toc}

## Scenario
In this lab, I’ll be using Burp Suite and PortSwigger’s Path Traversal Lab to demonstrate a directory traversal vulnerability.  According to <a href="https://owasp.org/www-community/attacks/Path_Traversal" target="blank">OWASP</a>:

> A path traversal attack (also known as directory traversal) aims to access files and directories that are stored outside the web root folder. By manipulating variables that reference files with “dot-dot-slash (../)” sequences and its variations or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system including application source code or configuration and critical system files.

This type of attack can occur when a browser sends a request for a file, such as an image, to the web server and an attacker captures this request. The captured request can then be manipulated to allow the attacker to navigate out of the directory where the image is stored and into another directory.

## Goals & Objectives
1. Run Kali Linux and start Burp Suite
2. Navigate to the PortSwigger’s File Path Traversal lab and begin the lab
3. Using Burp Suite, intercept and capture a GET request by Firefox
4. Manipulate the request using Repeater to traverse out of the current directory
5. Complete the lab by locating and accessing the “passwd” file

## Results
### 📄 Task 1: Run Burp Suite in Kali Linux

Typing ```burpsuite``` into the terminal starts Burp Suite.  Burp Suite is widely used by security professionals, penetration testers, and developers to identify and fix security vulnerabilities in web applications.  

In the Proxy tab, I turn off Intercept mode so that it does not capture HTTP requests by Firefox as I navigate to PortSwigger’s lab.

![](/assets/images/101_27_burp1/step1.png)

<br>
<br>
### 📄 Task 2: Start the PortSwigger lab

I begin the PortSwigger “File path traversal, simple case” lab. I am presented with a fake online shop. To solve the lab, I must retrieve the contents of the /etc/passwd file. 

![](/assets/images/101_27_burp1/step2.png)

<br>
<br>
### 📄 Task 3: Enable Intercept mode in Burp Suite and capture a GET request

I turn on Intercept mode and then I click on one of the items in the shop. Burp Suite immediately captures the request for the image of that item. The request is paused before it reaches the web server so that I can analyze it.

![](/assets/images/101_27_burp1/step3a.png)
*Burp Suite preparing to intercept a GET request from Firefox*

![](/assets/images/101_27_burp1/step3b.png)
*Burp Suite captures the GET request*

<br>
<br>
### 📄 Task 4: Send the GET request to Burp Suite’s Repeater tool

The first line in the request ```GET /image?filename=70.jpg HTTP/2``` shows Firefox requesting an image file from the web server.

![](/assets/images/101_27_burp1/step5a.png)

Right-clicking on the GUI will bring up the context menu where I select “Send to Repeater.” The captured request is sent to Repeater so that I can modify it.

![](/assets/images/101_27_burp1/step4.png)

<br>
<br>
### 📄 Task 5: Manipulate the GET request

In the Repeater tab, I will replace the image file name with a series of “../” and ending with etc/passwd. This will allow me to traverse the file system, enter the etc directory, and access the passwd file.

![](/assets/images/101_27_burp1/step5_final.png)

In Linux, "../" is relative path notation. When this is entered into the terminal, I can traverse, or navigate, one level up into the parent directory of the current working directory. If "../" is used several times, I will eventually find myself in the root directory of the file system, where the etc directory is located. Once inside etc, I can access the passwd file.

<br>
<br>
### 📄 Task 6: Send the modified request to the web server

Clicking the Send button in Burp Suite sends the modified request to the web server. The server returns the contents of the passwd file, which completes this PortSwigger lab.

![](/assets/images/101_27_burp1/step6.png)
*Contents of the passwd file revealed and highlighted in the red box*

![](/assets/images/101_27_burp1/labsolved.png)
*Lab solved!*

---

<a href="#top" id="back-to-top">Back to top</a>